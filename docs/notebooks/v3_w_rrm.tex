\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}
    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for grffile with XeLaTeX
    \def\Gread@@xetex#1{%
      \IfFileExists{"\Gin@base".bb}%
      {\Gread@eps{\Gin@base.bb}}%
      {\Gread@@xetex@aux#1}%
    }
    \makeatother

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{Untitled}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        \ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \hypertarget{final-notebook}{%
\section{Final Notebook}\label{final-notebook}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{459}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{o}{\PYZpc{}}\PY{k}{load\PYZus{}ext} line\PYZus{}profiler
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
The line\_profiler extension is already loaded. To reload it, use:
  \%reload\_ext line\_profiler
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{Bio}\PY{n+nn}{.}\PY{n+nn}{SubsMat} \PY{k}{import} \PY{n}{MatrixInfo} \PY{k}{as} \PY{n}{matlist}

\PY{k}{class} \PY{n+nc}{SeqData}\PY{p}{:}

    \PY{n}{CONV} \PY{o}{=} \PY{p}{\PYZob{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NUM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EIIP}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{l+m+mf}{0.0946}\PY{p}{,} \PY{l+m+mf}{0.0516}\PY{p}{,} \PY{l+m+mf}{0.0548}\PY{p}{,} \PY{l+m+mf}{0.0373}\PY{p}{,} \PY{l+m+mf}{0.0057}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{0.0823}\PY{p}{,}\PYZbs{}
                 \PY{l+m+mf}{0.0829}\PY{p}{,} \PY{l+m+mf}{0.0941}\PY{p}{,} \PY{l+m+mf}{0.0036}\PY{p}{,} \PY{l+m+mf}{0.0761}\PY{p}{,} \PY{l+m+mf}{0.0198}\PY{p}{,} \PY{l+m+mf}{0.005}\PY{p}{,} \PY{l+m+mf}{0.1263}\PY{p}{,} \PY{l+m+mf}{0.0058}\PY{p}{,} \PYZbs{}
                 \PY{l+m+mf}{0.0371}\PY{p}{,} \PY{l+m+mf}{0.0242}\PY{p}{,} \PY{l+m+mf}{0.0959}\PY{p}{,} \PY{l+m+mf}{0.0829}\PY{p}{]}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FNS}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Aromatic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Aromatic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Aromatic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hydrophobic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hydrophobic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PYZbs{}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hydrophobic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hydrophobic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hydrophobic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Polar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Polar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Polar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PYZbs{}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Polar}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Proline}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Glycine}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Charge (\PYZhy{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Charge (\PYZhy{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Charge (+)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PYZbs{}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Charge (+)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Charge (+)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Excluded}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
    \PY{p}{\PYZcb{}}
    \PY{c+c1}{\PYZsh{} @TODO: Import Biopython dicts of matrices, not read from .csvs}
    \PY{n}{MATR} \PY{o}{=} \PY{p}{\PYZob{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PAM30}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./src\PYZus{}data/pam30.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index\PYZus{}col}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{to\PYZus{}dict}\PY{p}{(}\PY{p}{)}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BLOSUM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./src\PYZus{}data/BLOSUM.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index\PYZus{}col}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{to\PYZus{}dict}\PY{p}{(}\PY{p}{)}\PY{p}{,}
    \PY{p}{\PYZcb{}}
    \PY{n}{DIST} \PY{o}{=} \PY{p}{\PYZob{}}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{jaro\PYZus{}winkler}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{(}\PY{k}{lambda} \PY{n}{p1}\PY{p}{,} \PY{n}{p2}\PY{p}{:} \PY{n}{td}\PY{o}{.}\PY{n}{jaro\PYZus{}winkler}\PY{o}{.}\PY{n}{normalized\PYZus{}similarity}\PY{p}{(}\PY{n}{p1}\PY{p}{,} \PY{n}{p2}\PY{p}{)}\PY{p}{)}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{needleman\PYZus{}wunsch}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{(}\PY{k}{lambda} \PY{n}{p1}\PY{p}{,} \PY{n}{p2}\PY{p}{:} \PY{n}{td}\PY{o}{.}\PY{n}{needleman\PYZus{}wunsch}\PY{o}{.}\PY{n}{normalized\PYZus{}similarity}\PY{p}{(}\PY{n}{p1}\PY{p}{,} \PY{n}{p2}\PY{p}{)}\PY{p}{)}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{smith\PYZus{}waterman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{(}\PY{k}{lambda} \PY{n}{p1}\PY{p}{,} \PY{n}{p2}\PY{p}{:} \PY{n}{td}\PY{o}{.}\PY{n}{smith\PYZus{}waterman}\PY{o}{.}\PY{n}{normalized\PYZus{}similarity}\PY{p}{(}\PY{n}{p1}\PY{p}{,} \PY{n}{p2}\PY{p}{)}\PY{p}{)}\PY{p}{,}
        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{levenshtein}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{(}\PY{k}{lambda} \PY{n}{p1}\PY{p}{,} \PY{n}{p2}\PY{p}{:} \PY{n}{td}\PY{o}{.}\PY{n}{levenshtein}\PY{o}{.}\PY{n}{normalized\PYZus{}similarity}\PY{p}{(}\PY{n}{p1}\PY{p}{,} \PY{n}{p2}\PY{p}{)}\PY{p}{)}
    \PY{p}{\PYZcb{}}
    
    \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{conv}\PY{o}{=}\PY{n}{CONV}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{matr}\PY{o}{=}\PY{n}{MATR}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{dist}\PY{o}{=}\PY{n}{DIST}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{:}
        
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{conv} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{cnv}\PY{p}{:}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{CONV}\PY{p}{[}\PY{n}{cnv}\PY{p}{]} \PY{k}{for} \PY{n}{cnv} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{CONV}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n}{cnv} \PY{o+ow}{in} \PY{n}{conv}\PY{p}{\PYZcb{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{matr} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{mtr}\PY{p}{:}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{MATR}\PY{p}{[}\PY{n}{mtr}\PY{p}{]} \PY{k}{for} \PY{n}{mtr} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{MATR}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n}{mtr} \PY{o+ow}{in} \PY{n}{matr}\PY{p}{\PYZcb{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{dist} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{dst}\PY{p}{:}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{DIST}\PY{p}{[}\PY{n}{dst}\PY{p}{]} \PY{k}{for} \PY{n}{dst} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{DIST}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n}{dst} \PY{o+ow}{in} \PY{n}{dist}\PY{p}{\PYZcb{}}
    
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{118}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{Class to calculate several simialrity metrics for an input list of peptides given a sequence string to compare it to.}
\PY{l+s+sd}{USAGE: }
\PY{l+s+sd}{1. Create SequenceSimilarityObject(\PYZob{}sequence string\PYZcb{}, \PYZob{}dictionary of data paths\PYZcb{} (to be deprecated soon \PYZhy{}\PYZhy{} use}
\PY{l+s+sd}{   internal class data), \PYZob{}path to peptides csv\PYZcb{}, \PYZob{}column title of sequence values of aforementioned peptides csv\PYZcb{})}
\PY{l+s+sd}{   for any number of sequences you want to be compared to the list of peptides}
\PY{l+s+sd}{2. For each object, call object.generate\PYZus{}similarity() to fill out the Dataframe with similarity metrics}
\PY{l+s+sd}{3. To whittle down this similarity matrix to list only those peptides with pattern matching of a minimum length}
\PY{l+s+sd}{   at a matching index in the rerence peptide (henceforth the binder), call object.get\PYZus{}df\PYZus{}with\PYZus{}binder\PYZus{}subseqs(min\PYZus{}length=\PYZob{}\PYZsh{}\PYZcb{})}
\PY{l+s+sd}{@ Author: Chris Pecunies, with help from Savvy Gupta and Aaron Tsang}
\PY{l+s+sd}{@ Date: February 12, 2020}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{from} \PY{n+nn}{typing} \PY{k}{import} \PY{n}{Set}\PY{p}{,} \PY{n}{Tuple}\PY{p}{,} \PY{n}{Dict}\PY{p}{,} \PY{n}{List}
\PY{k+kn}{from} \PY{n+nn}{scipy} \PY{k}{import} \PY{n}{stats}\PY{p}{,} \PY{n}{signal}\PY{p}{,} \PY{n}{fft}
\PY{c+c1}{\PYZsh{}import sci\PYZhy{}kit learn}
\PY{k+kn}{import} \PY{n+nn}{textdistance} \PY{k}{as} \PY{n+nn}{td}
\PY{k+kn}{from} \PY{n+nn}{Bio} \PY{k}{import} \PY{n}{pairwise2}
\PY{k+kn}{from} \PY{n+nn}{Bio}\PY{n+nn}{.}\PY{n+nn}{SubsMat} \PY{k}{import} \PY{n}{MatrixInfo} \PY{k}{as} \PY{n}{matlist}

\PY{k}{class} \PY{n+nc}{SequenceSimilarity}\PY{p}{:}
    \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{    Class that takes in a path to a list of amino acid sequences as well}
\PY{l+s+sd}{    as any number of peptide sequences explicitly that are known to have}
\PY{l+s+sd}{    a certain set of properties. Generates metrics for similarity for each}
\PY{l+s+sd}{    peptide in path and returns domains AA sequence with high similarity}
\PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
    \PY{n}{AA} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FYWAVILMSTNQPGDEKHRC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
    
    \PY{k}{def} \PY{n+nf}{\PYZus{}\PYZus{}init\PYZus{}\PYZus{}}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{binder}\PY{p}{:} \PY{n}{Tuple}\PY{p}{[}\PY{n+nb}{str}\PY{p}{,} \PY{n+nb}{str}\PY{p}{]}\PY{p}{,}
                 \PY{n}{data}\PY{p}{:} \PY{n}{SeqData}\PY{p}{,}
                 \PY{n}{p\PYZus{}path}\PY{p}{:} \PY{n+nb}{str}\PY{p}{,}       
                 \PY{n}{aa\PYZus{}col}\PY{p}{:} \PY{n+nb}{str}\PY{p}{,}
                 \PY{n}{dists}\PY{p}{:} \PY{n}{List} \PY{o}{=} \PY{p}{[}\PY{p}{]}\PY{p}{,}   \PY{c+c1}{\PYZsh{}set dists = None for no dists}
                 \PY{n}{only\PYZus{}match}\PY{p}{:} \PY{n+nb}{bool} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,}
                 \PY{n}{min\PYZus{}length}\PY{p}{:} \PY{n+nb}{int} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:} 
        
        \PY{c+c1}{\PYZsh{} \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{} setting data \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{d} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{d}\PY{p}{:} \PY{n+nb}{vars}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{[}\PY{n}{d}\PY{p}{]} \PY{k}{for} \PY{n}{d} \PY{o+ow}{in} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{vars}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{\PYZcb{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{conv} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{d}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{conv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{aa\PYZus{}map} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{conv}\PY{p}{:}\PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{AA}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{d}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{conv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{conv}\PY{p}{]}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{conv} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{conv}\PY{p}{\PYZcb{}}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{conv\PYZus{}pep} \PY{o}{=} \PY{k}{lambda} \PY{n}{t}\PY{p}{,} \PY{n}{p}\PY{p}{:} \PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{aa\PYZus{}map}\PY{p}{[}\PY{n}{t}\PY{p}{]}\PY{p}{[}\PY{n}{AA}\PY{p}{]} \PY{k}{if} \PY{n}{AA} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{AA} \PY{k}{else} \PY{l+m+mi}{0} \PY{k}{for} \PY{n}{AA} \PY{o+ow}{in} \PY{n}{p}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sim\PYZus{}sum} \PY{o}{=} \PY{k}{lambda} \PY{n}{p1}\PY{p}{,} \PY{n}{p2}\PY{p}{,} \PY{n}{m}\PY{p}{:} \PY{n+nb}{sum}\PY{p}{(}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{d}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{matr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{m}\PY{p}{]}\PY{p}{[}\PY{n}{a1}\PY{p}{]}\PY{p}{[}\PY{n}{a2}\PY{p}{]} \PY{k}{for} \PY{n}{a1}\PY{p}{,} \PY{n}{a2} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{p1}\PY{p}{,} \PY{n}{p2}\PY{p}{)}\PY{p}{]}\PY{p}{)}
        
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{seq} \PY{o}{=} \PY{n}{aa\PYZus{}col}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sim\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PAM30}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BLOSUM45}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RRM\PYZus{}SN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RRM\PYZus{}Corr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted\PYZus{}matches}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{k}{if} \PY{n}{dists} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sim\PYZus{}cols} \PY{o}{+}\PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{d}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{o+ow}{not} \PY{n}{dists} \PY{k}{else} \PY{n}{dists}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{conv\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{n}{conv}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZus{}Seq}\PY{l+s+s1}{\PYZsq{}} \PY{k}{for} \PY{n}{conv} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{conv}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{cols} \PY{o}{=} \PY{p}{[}\PY{n}{aa\PYZus{}col}\PY{p}{]} \PY{o}{+} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sim\PYZus{}cols} \PY{o}{+} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{conv\PYZus{}cols}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bname}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{b} \PY{o}{=} \PY{n}{binder}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bsseq} \PY{o}{=} \PY{p}{[}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{b}\PY{p}{[}\PY{n}{i}\PY{p}{:}\PY{n}{j}\PY{p}{]}\PY{p}{,} \PY{n}{i}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{b}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{b}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
    
        \PY{c+c1}{\PYZsh{} \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{} helper lambda functions}
        
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}og} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{p\PYZus{}path}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}og}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{n}{aa\PYZus{}col}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}og}\PY{p}{[}\PY{n}{aa\PYZus{}col}\PY{p}{]}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}og} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}og}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}og}\PY{p}{[}\PY{n}{aa\PYZus{}col}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{contains}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{O}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}sl} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}og}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}og}\PY{p}{[}\PY{n}{aa\PYZus{}col}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{len}\PY{p}{(}\PY{p}{)} \PY{o}{==} \PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{b}\PY{p}{)}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}ls} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}sl}\PY{p}{[}\PY{n}{aa\PYZus{}col}\PY{p}{]}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}og} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}og}\PY{p}{[}\PY{n}{aa\PYZus{}col}\PY{p}{]}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
        \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}ls}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}  
            \PY{k}{raise} \PY{n+ne}{Exception}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{No peptides of same length as binder found}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{cols}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{seq}\PY{p}{]} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}ls}
        \PY{c+c1}{\PYZsh{} @TODO P STILL HAS DUPLICATES ????}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{update\PYZus{}similarities}\PY{p}{(}\PY{n}{dists}\PY{p}{)}
        
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}match} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{filter\PYZus{}by\PYZus{}bsseq}\PY{p}{(}\PY{n}{min\PYZus{}length}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}match\PYZus{}ls} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}match}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{seq}\PY{p}{]}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
        \PY{k}{if} \PY{n}{only\PYZus{}match}\PY{p}{:} 
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}ls} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}match}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}match\PYZus{}ls}
        
    \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}SET UP FUNCTIONS (void)\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZsh{}     }

    \PY{k}{def} \PY{n+nf}{\PYZus{}update\PYZus{}RRM\PYZus{}similarity}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{match\PYZus{}len} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{k+kc}{None}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{        Uses the Resonant Recognition Model as described by Irena Cosic to }
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{n}{rrm} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{o}{.}\PY{n}{index}\PY{p}{)}
        \PY{n}{eiip\PYZus{}seq} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EIIP\PYZus{}Seq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
        \PY{n}{rrm} \PY{o}{=} \PY{n}{rrm}\PY{o}{.}\PY{n}{assign}\PY{p}{(}
            \PY{n}{seq} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}ls}\PY{p}{,}
            \PY{n}{eiip} \PY{o}{=} \PY{n}{eiip\PYZus{}seq}\PY{p}{,}
            \PY{n}{dft} \PY{o}{=} \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{rfft}\PY{p}{(}\PY{n}{eiip}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{eiip}\PY{p}{)} \PY{k}{for} \PY{n}{eiip} \PY{o+ow}{in} \PY{n}{eiip\PYZus{}seq}\PY{p}{]}\PY{p}{,}
            \PY{n}{dft2} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{rfft}\PY{p}{(}\PY{n}{eiip}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{eiip}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{eiip} \PY{o+ow}{in} \PY{n}{eiip\PYZus{}seq}\PY{p}{]}\PY{p}{,}
            \PY{n}{freq} \PY{o}{=} \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftfreq}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{eiip}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n+nb}{int}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{eiip}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{eiip} \PY{o+ow}{in} \PY{n}{eiip\PYZus{}seq}\PY{p}{]}\PY{p}{,}
            \PY{n}{power} \PY{o}{=} \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{rfft}\PY{p}{(}\PY{n}{eiip}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{eiip}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2} \PY{k}{for} \PY{n}{eiip} \PY{o+ow}{in} \PY{n}{eiip\PYZus{}seq}\PY{p}{]}\PY{p}{,}
        \PY{p}{)}
        \PY{n}{bind\PYZus{}eiip} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{conv\PYZus{}pep}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EIIP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{b}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bind\PYZus{}eiip\PYZus{}dft} \PY{o}{=} \PY{l+m+mi}{2}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{rfft}\PY{p}{(}\PY{n}{bind\PYZus{}eiip}\PY{p}{)}\PY{o}{/}\PY{n+nb}{len}\PY{p}{(}\PY{n}{bind\PYZus{}eiip}\PY{p}{)}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bind\PYZus{}freq} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftfreq}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{bind\PYZus{}eiip}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n+nb}{int}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{bind\PYZus{}eiip}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bind\PYZus{}peak} \PY{o}{=} \PY{n}{signal}\PY{o}{.}\PY{n}{find\PYZus{}peaks}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bind\PYZus{}eiip\PYZus{}dft}\PY{p}{)}
        \PY{n}{peaks} \PY{o}{=} \PY{p}{[}\PY{n}{signal}\PY{o}{.}\PY{n}{find\PYZus{}peaks}\PY{p}{(}\PY{n}{d}\PY{p}{)} \PY{k}{for} \PY{n}{d} \PY{o+ow}{in} \PY{n}{rrm}\PY{o}{.}\PY{n}{dft2}\PY{p}{]}
        \PY{n}{rrm}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{peak\PYZus{}loc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n}{p}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{peaks}\PY{p}{]}
        \PY{n}{rrm}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{peak\PYZus{}val}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n}{p}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{peaks}\PY{p}{]}
        \PY{n}{rrm}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{peak\PYZus{}dist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{p}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bind\PYZus{}peak}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n}{peaks}\PY{p}{]}
        \PY{n}{rrm}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{correlate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n}{signal}\PY{o}{.}\PY{n}{correlate}\PY{p}{(}\PY{n}{d}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bind\PYZus{}eiip\PYZus{}dft}\PY{p}{)} \PY{k}{for} \PY{n}{d} \PY{o+ow}{in} \PY{n}{rrm}\PY{o}{.}\PY{n}{dft2}\PY{p}{]}
        \PY{n}{rrm}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{convolve}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{n}{signal}\PY{o}{.}\PY{n}{convolve}\PY{p}{(}\PY{n}{d}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bind\PYZus{}eiip\PYZus{}dft}\PY{p}{)} \PY{k}{for} \PY{n}{d} \PY{o+ow}{in} \PY{n}{rrm}\PY{o}{.}\PY{n}{dft2}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{rrm} \PY{o}{=} \PY{n}{rrm}
        
        \PY{k}{def} \PY{n+nf}{get\PYZus{}max\PYZus{}seqs}\PY{p}{(}\PY{n}{num} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{,} \PY{n}{typ}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{correlate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
            \PY{n}{maxes} \PY{o}{=} \PY{p}{[}\PY{n}{signal}\PY{o}{.}\PY{n}{find\PYZus{}peaks}\PY{p}{(}\PY{n}{rrm}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{o}{.}\PY{n}{correlate}\PY{p}{)} \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{rrm}\PY{p}{)}\PY{p}{)}\PY{p}{]}
            \PY{n}{maxheight} \PY{o}{=} \PY{p}{[}\PY{n}{rrm}\PY{p}{[}\PY{n}{typ}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{m}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{m} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{maxes}\PY{p}{)}\PY{p}{]}
            \PY{n}{top\PYZus{}idx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{maxheight}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{n}{num}\PY{p}{:}\PY{p}{]}
            \PY{n}{top\PYZus{}values} \PY{o}{=} \PY{p}{[}\PY{n}{maxheight}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{top\PYZus{}idx}\PY{p}{]}
            \PY{n}{top\PYZus{}seq} \PY{o}{=} \PY{p}{[}\PY{n}{top\PYZus{}seq}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{rex}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{top\PYZus{}idx}\PY{p}{]}
            \PY{n}{top\PYZus{}data} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{seq}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{top\PYZus{}seq}\PY{p}{)}\PY{p}{]}
            \PY{k}{return} \PY{n}{top\PYZus{}data}
            
        \PY{k}{def} \PY{n+nf}{plot}\PY{p}{(}\PY{n}{col} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{column}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:} \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{rrm}\PY{o}{.}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{)}
        \PY{k}{def} \PY{n+nf}{merge}\PY{p}{(}\PY{p}{)}\PY{p}{:} \PY{k}{return} \PY{n}{rrm}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{,} \PY{n}{left\PYZus{}on}\PY{o}{=}\PY{n}{rrm}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{right\PYZus{}on}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{o}{.}\PY{n}{index}\PY{p}{)}
    
    
    \PY{c+c1}{\PYZsh{} NOTE! Adds columns \PYZdq{}Matching\PYZus{}sseqs\PYZdq{} and \PYZdq{}Num\PYZus{}matching\PYZdq{} to output}
    \PY{c+c1}{\PYZsh{} Might be too unwieldy / unhelpful for output similarity data}
    \PY{c+c1}{\PYZsh{} if so, just comment out \PYZus{}update\PYZus{}matching\PYZus{}sseqs()}
    \PY{k}{def} \PY{n+nf}{\PYZus{}update\PYZus{}matching\PYZus{}sseqs}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{w1}\PY{p}{:} \PY{n+nb}{float} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{w2}\PY{p}{:} \PY{n+nb}{float} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{k+kc}{None}\PY{p}{:}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{        Returns a number as a new column representing the number of \PYZdq{}matches\PYZdq{} a peptide}
\PY{l+s+sd}{        has for all possible subsequences for the binder inputted at a given index. For}
\PY{l+s+sd}{        weighting=1, all matches are treated equally (\PYZsq{}Y\PYZsq{} at position 3 is treated equal}
\PY{l+s+sd}{        to IMV at position 0) but lowering weighting lowers smaller\PYZhy{}length matches}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{c+c1}{\PYZsh{} @TODO Remove \PYZdq{}duplicates\PYZdq{} which occur at different matching indexes of binder}
        \PY{c+c1}{\PYZsh{} but are part of a larger pattern already recorded at an earlier index}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{o}{.}\PY{n}{sseq\PYZus{}matches}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{o}{.}\PY{n}{weighted\PYZus{}matches} \PY{o}{=} \PY{k+kc}{None}\PY{p}{,} \PY{k+kc}{None}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bsseq}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{key} \PY{o}{=} \PY{k}{lambda} \PY{n}{ss}\PY{p}{:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{ss}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{reverse}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{n}{score}\PY{p}{:} \PY{n+nb}{float} \PY{o}{=} \PY{k}{lambda} \PY{n}{s}\PY{p}{:} \PY{p}{(}\PY{n}{w1} \PY{o}{*} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{s}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{n}{w2}\PY{p}{)}
        \PY{n}{matches}\PY{p}{:} \PY{n}{List} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{nmatches} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{p}{)}
        \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{seq} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}ls}\PY{p}{)}\PY{p}{:}
            \PY{n}{matches}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{;} \PY{n}{nmatches}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{p}{)}\PY{p}{)}
            \PY{n}{trigger} \PY{o}{=} \PY{k+kc}{False}
            \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{seq}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                \PY{k}{if} \PY{n}{trigger}\PY{p}{:} \PY{k}{break}
                \PY{n}{trigger} \PY{o}{=} \PY{k+kc}{False}
                \PY{k}{for} \PY{p}{(}\PY{n}{sseq}\PY{p}{,} \PY{n}{bin\PYZus{}i}\PY{p}{)} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bsseq}\PY{p}{:}
                    \PY{n}{in\PYZus{}seq} \PY{o}{=} \PY{n}{seq}\PY{p}{[}\PY{n}{j}\PY{p}{:}\PY{n+nb}{len}\PY{p}{(}\PY{n}{sseq}\PY{p}{)}\PY{o}{+}\PY{n}{j}\PY{p}{]}
                    \PY{k}{if} \PY{p}{(}\PY{n}{bin\PYZus{}i} \PY{o}{==} \PY{n}{j}\PY{p}{)} \PY{o+ow}{and} \PY{p}{(}\PY{n}{in\PYZus{}seq} \PY{o}{==} \PY{n}{sseq}\PY{p}{)}\PY{p}{:}
                        \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{matches}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0} \PY{o+ow}{and} \PY{n}{matches}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{find}\PY{p}{(}\PY{n}{sseq}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{:}
                            \PY{n}{trigger} \PY{o}{=} \PY{k+kc}{True}
                            \PY{k}{break}
                        \PY{n}{matches}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{sseq}\PY{p}{,} \PY{n}{bin\PYZus{}i}\PY{p}{)}\PY{p}{)}
                        \PY{n}{nmatches}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{score}\PY{p}{(}\PY{n}{sseq}\PY{p}{)}
                        \PY{k}{break}
\PY{c+c1}{\PYZsh{}         matches = [pairwise2.align.localxx(s, self.b) for s in self.p\PYZus{}ls]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{o}{.}\PY{n}{sseq\PYZus{}matches}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{o}{.}\PY{n}{weighted\PYZus{}matches} \PY{o}{=} \PY{n}{matches}\PY{p}{,} \PY{n}{nmatches}
                
    \PY{k}{def} \PY{n+nf}{update\PYZus{}similarities}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{metrics}\PY{p}{:} \PY{n}{List} \PY{o}{=} \PY{p}{[}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{k+kc}{None}\PY{p}{:}
        \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{        Updates the similarity values whenever called (for now should be only once right}
\PY{l+s+sd}{        after creating the object, ecept possibly if the Binding peptide is updated}
\PY{l+s+sd}{        (should be handled automatically)}
\PY{l+s+sd}{        \PYZsq{}\PYZsq{}\PYZsq{}}
        \PY{n}{matrices} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{d}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{matr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{n}{cdata} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{conv\PYZus{}pep}\PY{p}{(}\PY{n}{c}\PY{p}{,} \PY{n}{p}\PY{p}{)} \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{conv}\PY{p}{]} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}ls}\PY{p}{]}
        \PY{n}{mdata} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sim\PYZus{}sum}\PY{p}{(}\PY{n}{p}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{b}\PY{p}{,} \PY{n}{m}\PY{p}{)} \PY{k}{for} \PY{n}{m} \PY{o+ow}{in} \PY{n}{matrices}\PY{p}{]} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}ls}\PY{p}{]}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{conv\PYZus{}cols}\PY{p}{]} \PY{o}{=} \PY{n}{cdata}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{n}{matrices}\PY{p}{]} \PY{o}{=} \PY{n}{mdata}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}update\PYZus{}matching\PYZus{}sseqs}\PY{p}{(}\PY{p}{)}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{\PYZus{}update\PYZus{}RRM\PYZus{}similarity}\PY{p}{(}\PY{p}{)}
        \PY{k}{if} \PY{n}{metrics} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
            \PY{n}{dists} \PY{o}{=} \PY{n}{metrics} \PY{k}{if} \PY{o+ow}{not} \PY{n+nb}{len}\PY{p}{(}\PY{n}{metrics}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0} \PY{k}{else} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{d}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}
            \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{n}{dists}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{d}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{d}\PY{p}{]}\PY{p}{(}\PY{n}{p}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{b}\PY{p}{)} \PY{k}{for} \PY{n}{d} \PY{o+ow}{in} \PY{n}{dists}\PY{p}{]} \PY{k}{for} \PY{n}{p} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}ls}\PY{p}{]}
        \PY{c+c1}{\PYZsh{} OPTIONAL}
        \PY{c+c1}{\PYZsh{} self.\PYZus{}unpack\PYZus{}num\PYZus{}encoding()}
        
        
        
    \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}MAIN CLASS FUNCTIONS (returns data) \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZsh{}}
    
    \PY{k}{def} \PY{n+nf}{filter\PYZus{}by\PYZus{}sseq}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{sseq}\PY{p}{:} \PY{n+nb}{str}\PY{p}{,} \PY{n}{ind}\PY{p}{:} \PY{n+nb}{int}\PY{p}{)}\PY{p}{:}
        \PY{k}{return} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{seq}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{find}\PY{p}{(}\PY{n}{sseq}\PY{p}{)} \PY{o}{==} \PY{n}{ind}\PY{p}{]}
        
    \PY{k}{def} \PY{n+nf}{filter\PYZus{}by\PYZus{}bsseq}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{min\PYZus{}len}\PY{p}{:} \PY{n+nb}{int} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
        \PY{n}{bsseq\PYZus{}dfs} \PY{o}{=} \PY{p}{[}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{filter\PYZus{}by\PYZus{}sseq}\PY{p}{(}\PY{n}{ss}\PY{p}{,}\PY{n}{i}\PY{p}{)} \PY{k}{for} \PY{p}{(}\PY{n}{ss}\PY{p}{,}\PY{n}{i}\PY{p}{)} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bsseq} \PY{k}{if} \PY{n+nb}{len}\PY{p}{(}\PY{n}{ss}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{o}{=}\PY{n}{min\PYZus{}len}\PY{p}{]}
        \PY{k}{return} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{n}{bsseq\PYZus{}dfs}\PY{p}{)}
    
    \PY{k}{def} \PY{n+nf}{get\PYZus{}distances}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{seqs1}\PY{p}{:} \PY{n+nb}{list}\PY{p}{,} \PY{n}{seqs2}\PY{p}{:} \PY{n+nb}{list}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{List}\PY{p}{[}\PY{n+nb}{float}\PY{p}{]}\PY{p}{:}
        \PY{k}{pass}
    
    \PY{k}{def} \PY{n+nf}{merge\PYZus{}data}\PY{p}{(}\PY{n+nb+bp}{self}\PY{p}{,} \PY{n}{other}\PY{p}{,} \PY{n}{sep\PYZus{}cols} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)} \PY{o}{\PYZhy{}}\PY{o}{\PYZgt{}} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{:}
        \PY{c+c1}{\PYZsh{} !!! IMPORTANT: \PYZdq{}other\PYZdq{} must also be SequenceSimilarity object (couldnt compile)}
        \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
\PY{l+s+sd}{        Returns a merged Dataframe of self.p and another SequenceSimilarity\PYZsq{}s pep\PYZus{}data.}
\PY{l+s+sd}{        If sep\PYZus{}cols=True, then the other SequenceSimilarity\PYZsq{}s columns will simply be appended}
\PY{l+s+sd}{        to the returned DataFrame (self.p is unchanged). If False, results will be averaged.}
\PY{l+s+sd}{        @NOTE: This is a super naive implementatoin \PYZhy{}\PYZhy{} expand this to make it more configurable}
\PY{l+s+sd}{        @TODO: Take in *others as a list of arbitrarily many other SequenceSimilarities to compare}
\PY{l+s+sd}{        \PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{c+c1}{\PYZsh{} must be same length binders \PYZhy{}\PYZgt{} so same peptides of interest}
        \PY{n}{this\PYZus{}data} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        \PY{n}{other\PYZus{}data} \PY{o}{=} \PY{n}{other}\PY{o}{.}\PY{n}{p}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        \PY{n}{sim\PYZus{}cols} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{sim\PYZus{}cols}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{n}{sim\PYZus{}cols}\PY{p}{)}
        \PY{k}{if} \PY{n}{sep\PYZus{}cols}\PY{p}{:}
            \PY{n}{suf} \PY{o}{=} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bname}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n}{other}\PY{o}{.}\PY{n}{bname}\PY{p}{)}
            \PY{n}{out} \PY{o}{=} \PY{n}{this\PYZus{}data}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{right}\PY{o}{=}\PY{n}{other\PYZus{}data}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{seq}\PY{p}{,} \PY{n}{suffixes}\PY{o}{=}\PY{p}{(}\PY{n}{suf}\PY{p}{)}\PY{p}{)}
            \PY{n}{out} \PY{o}{=} \PY{n}{out}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{p}{)}
            \PY{k}{return} \PY{n}{out}

        \PY{n}{new\PYZus{}cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZus{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZus{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{col}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bname}\PY{p}{,} \PY{n}{other}\PY{o}{.}\PY{n}{bname}\PY{p}{)} \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{sim\PYZus{}cols}\PY{p}{]}
        \PY{n}{out\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n}{this\PYZus{}data}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{seq\PYZus{}cols} \PY{o}{+} \PY{n}{new\PYZus{}cols}\PY{p}{)}
        \PY{n}{out\PYZus{}data}\PY{p}{[}\PY{n}{seq\PYZus{}cols}\PY{p}{]} \PY{o}{=} \PY{n}{this\PYZus{}data}\PY{p}{[}\PY{n}{seq\PYZus{}cols}\PY{p}{]}
        \PY{n}{both} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{this\PYZus{}data}\PY{p}{[}\PY{n}{non\PYZus{}seq\PYZus{}cols}\PY{p}{]}\PY{p}{,}\PY{n}{other\PYZus{}data}\PY{p}{[}\PY{n}{non\PYZus{}seq\PYZus{}cols}\PY{p}{]}\PY{p}{]}\PY{p}{)}
        \PY{n}{out\PYZus{}data}\PY{p}{[}\PY{n}{new\PYZus{}cols}\PY{p}{]} \PY{o}{=} \PY{n}{both}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{n}{both}\PY{o}{.}\PY{n}{index}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
        \PY{k}{if} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sseq\PYZus{}matches}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{cols} \PY{o+ow}{or} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sseq\PYZus{}matches}\PY{l+s+s1}{\PYZsq{}} \PY{o+ow}{in} \PY{n}{other}\PY{o}{.}\PY{n}{cols}\PY{p}{:}
            \PY{n}{both\PYZus{}match} \PY{o}{=} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sseq\PYZus{}matches}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{other}\PY{o}{.}\PY{n}{pdata}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sseq\PYZus{}matches}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
            \PY{n}{both}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sseq\PYZus{}matches}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{both\PYZus{}match}
            \PY{n}{out\PYZus{}data}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{both\PYZus{}match}\PY{p}{)}
        \PY{k}{return} \PY{n}{out\PYZus{}data}
                    
        \PY{c+c1}{\PYZsh{}@TODO Finish}
                
                
    \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}miscellaneous methods\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZsh{}}
    
\PY{c+c1}{\PYZsh{}     def get\PYZus{}kendalltau\PYZus{}corr\PYZus{}map(self) \PYZhy{}\PYZgt{} Tuple:}
\PY{c+c1}{\PYZsh{}         return stats.kendalltau(self.data[\PYZsq{}AA\PYZus{}MAP\PYZsq{}][[\PYZsq{}Num\PYZsq{}]], self.data[\PYZsq{}AA\PYZus{}MAP\PYZsq{}][[\PYZsq{}EIIP\PYZsq{}]])}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{119}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{DATA} \PY{o}{=} \PY{n}{SeqData}\PY{p}{(}\PY{p}{)}
\PY{n}{SEQS} \PY{o}{=} \PY{p}{[}
    \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GRBP5}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{IMVTESSDYSSY}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,}
    \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M6}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{IMVTASSAYDDY}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{p}{]}
\PY{n}{AA\PYZus{}COL} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sequences}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{PEP\PYZus{}PATH} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./src\PYZus{}data/Sequence\PYZus{}data.csv}\PY{l+s+s1}{\PYZsq{}} 
\PY{n}{dat1} \PY{o}{=} \PY{p}{\PYZob{}}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grbp5\PYZus{}sim}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{n}{SequenceSimilarity}\PY{p}{(}\PY{n}{SEQS}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{DATA}\PY{p}{,} \PY{n}{PEP\PYZus{}PATH}\PY{p}{,} \PY{n}{AA\PYZus{}COL}\PY{p}{)}\PY{p}{,}
    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m6\PYZus{}sim}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{n}{SequenceSimilarity}\PY{p}{(}\PY{n}{SEQS}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{DATA}\PY{p}{,} \PY{n}{PEP\PYZus{}PATH}\PY{p}{,} \PY{n}{AA\PYZus{}COL}\PY{p}{)}
\PY{p}{\PYZcb{}}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\PY{l+s+sd}{dat2 = \PYZob{}}
\PY{l+s+sd}{    \PYZsq{}both\PYZus{}sep\PYZus{}sim\PYZsq{} : dat1[\PYZsq{}grbp5\PYZus{}sim\PYZsq{}].merge\PYZus{}data(other=dat1[\PYZsq{}m6\PYZus{}sim\PYZsq{}], sep\PYZus{}cols=True),}
\PY{l+s+sd}{    \PYZsq{}both\PYZus{}avg\PYZus{}sim\PYZsq{} : dat1[\PYZsq{}grbp5\PYZus{}sim\PYZsq{}].merge\PYZus{}data(other=dat1[\PYZsq{}m6\PYZus{}sim\PYZsq{}], sep\PYZus{}cols=False),}
\PY{l+s+sd}{    \PYZsq{}both\PYZus{}sep\PYZus{}sim\PYZus{}match\PYZsq{} : dat1[\PYZsq{}grbp5\PYZus{}sim\PYZus{}match\PYZsq{}].merge\PYZus{}data(other=dat1[\PYZsq{}m6\PYZus{}sim\PYZus{}match\PYZsq{}], sep\PYZus{}cols=True),}
\PY{l+s+sd}{    \PYZsq{}both\PYZus{}avg\PYZus{}sim\PYZus{}match\PYZsq{} : dat1[\PYZsq{}grbp5\PYZus{}sim\PYZus{}match\PYZsq{}].merge\PYZus{}data(other=dat1[\PYZsq{}m6\PYZus{}sim\PYZus{}match\PYZsq{}], sep\PYZus{}cols=False),}
\PY{l+s+sd}{\PYZcb{}}
\PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/usr/lib/python3.7/site-packages/ipykernel\_launcher.py:150: FutureWarning:
Passing list-likes to .loc or [] with any missing label will raise
KeyError in the future, you can use .reindex() as an alternative.

See the documentation here:
https://pandas.pydata.org/pandas-docs/stable/user\_guide/indexing.html\#deprecate-
loc-reindex-listlike
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{119}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
"\textbackslash{}ndat2 = \{\textbackslash{}n    'both\_sep\_sim' :
dat1['grbp5\_sim'].merge\_data(other=dat1['m6\_sim'], sep\_cols=True),\textbackslash{}n
'both\_avg\_sim' : dat1['grbp5\_sim'].merge\_data(other=dat1['m6\_sim'],
sep\_cols=False),\textbackslash{}n    'both\_sep\_sim\_match' :
dat1['grbp5\_sim\_match'].merge\_data(other=dat1['m6\_sim\_match'], sep\_cols=True),\textbackslash{}n
'both\_avg\_sim\_match' :
dat1['grbp5\_sim\_match'].merge\_data(other=dat1['m6\_sim\_match'],
sep\_cols=False),\textbackslash{}n\}\textbackslash{}n"
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{123}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{d1} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{dat1}\PY{o}{.}\PY{n}{values}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n}{d1d} \PY{o}{=} \PY{p}{[}\PY{n}{d}\PY{o}{.}\PY{n}{p} \PY{k}{for} \PY{n}{d} \PY{o+ow}{in} \PY{n}{d1}\PY{p}{]}
\PY{n}{rex} \PY{o}{=} \PY{n}{d1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{rrm}
\PY{n}{rex}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{123}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
            seq                                               eiip  \textbackslash{}
0  SVPHFSDEDKDP  [0.0829, 0.0057, 0.0198, 0.0242, 0.0946, 0.082{\ldots}
1  VPHFSDEDKDPE  [0.0057, 0.0198, 0.0242, 0.0946, 0.0829, 0.126{\ldots}
2  SVPHFSEEEKEA  [0.0829, 0.0057, 0.0198, 0.0242, 0.0946, 0.082{\ldots}
3  VPHFSEEEKEAE  [0.0057, 0.0198, 0.0242, 0.0946, 0.0829, 0.005{\ldots}
4  SVPHFSDEDKDP  [0.0829, 0.0057, 0.0198, 0.0242, 0.0946, 0.082{\ldots}

                                                 dft  \textbackslash{}
0  [(0.06264166666666665+0j), (-0.011294400459931{\ldots}
1  [(0.056216666666666665+0j), (-0.01955731388825{\ldots}
2  [(0.033975+0j), (1.021992058759744e-05-0.00823{\ldots}
3  [(0.027549999999999998+0j), (-0.00143547036225{\ldots}
4  [(0.06264166666666665+0j), (-0.011294400459931{\ldots}

                                                dft2  \textbackslash{}
0  [0.1252833333333333, 0.028179612473691253, 0.0{\ldots}
1  [0.11243333333333333, 0.039239587699259636, 0{\ldots}
2  [0.06795, 0.016479581260746716, 0.026961520934{\ldots}
3  [0.055099999999999996, 0.020884774229360296, 0{\ldots}
4  [0.1252833333333333, 0.028179612473691253, 0.0{\ldots}

                                                freq  \textbackslash{}
0  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
1  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
2  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
3  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
4  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}

                                               power peak\_loc peak\_val  \textbackslash{}
0  [0.003923978402777776, 0.0001985226397918539, {\ldots}       []       \{\}
1  [0.003160313611111111, 0.000384936310701972, 0{\ldots}       []       \{\}
2  [0.001154300625, 6.789414963238858e-05, 0.0001{\ldots}   [3, 5]       \{\}
3  [0.0007590024999999999, 0.00010904344865283799{\ldots}   [2, 5]       \{\}
4  [0.003923978402777776, 0.0001985226397918539, {\ldots}       []       \{\}

  peak\_dist                                          correlate  \textbackslash{}
0        []  [0.006080417777777776, 0.00369355025376957, 0{\ldots}
1        []  [0.005456764444444444, 0.003991765965944491, 0{\ldots}
2    [0, 2]  [0.00329784, 0.0020613087035645777, 0.00266369{\ldots}
3    [1, 2]  [0.002674186666666666, 0.002036545650201958, 0{\ldots}
4        []  [0.006080417777777776, 0.00369355025376957, 0{\ldots}

                                            convolve
0  [0.015639536111111105, 0.007005268555061297, 0{\ldots}
1  [0.014035427777777776, 0.008028216530542623, 0{\ldots}
2  [0.008482424999999998, 0.003948725996030621, 0{\ldots}
3  [0.006878316666666666, 0.004140935319768755, 0{\ldots}
4  [0.015639536111111105, 0.007005268555061297, 0{\ldots}
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{208}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rex}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{208}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
            seq                                               eiip  \textbackslash{}
0  SVPHFSDEDKDP  [0.0829, 0.0057, 0.0198, 0.0242, 0.0946, 0.082{\ldots}
1  VPHFSDEDKDPE  [0.0057, 0.0198, 0.0242, 0.0946, 0.0829, 0.126{\ldots}
2  SVPHFSEEEKEA  [0.0829, 0.0057, 0.0198, 0.0242, 0.0946, 0.082{\ldots}
3  VPHFSEEEKEAE  [0.0057, 0.0198, 0.0242, 0.0946, 0.0829, 0.005{\ldots}
4  SVPHFSDEDKDP  [0.0829, 0.0057, 0.0198, 0.0242, 0.0946, 0.082{\ldots}

                                                 dft  \textbackslash{}
0  [(0.06264166666666665+0j), (-0.011294400459931{\ldots}
1  [(0.056216666666666665+0j), (-0.01955731388825{\ldots}
2  [(0.033975+0j), (1.021992058759744e-05-0.00823{\ldots}
3  [(0.027549999999999998+0j), (-0.00143547036225{\ldots}
4  [(0.06264166666666665+0j), (-0.011294400459931{\ldots}

                                                dft2  \textbackslash{}
0  [0.1252833333333333, 0.028179612473691253, 0.0{\ldots}
1  [0.11243333333333333, 0.039239587699259636, 0{\ldots}
2  [0.06795, 0.016479581260746716, 0.026961520934{\ldots}
3  [0.055099999999999996, 0.020884774229360296, 0{\ldots}
4  [0.1252833333333333, 0.028179612473691253, 0.0{\ldots}

                                                freq  \textbackslash{}
0  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
1  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
2  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
3  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
4  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}

                                               power peak\_loc peak\_val  \textbackslash{}
0  [0.003923978402777776, 0.0001985226397918539, {\ldots}       []       \{\}
1  [0.003160313611111111, 0.000384936310701972, 0{\ldots}       []       \{\}
2  [0.001154300625, 6.789414963238858e-05, 0.0001{\ldots}   [3, 5]       \{\}
3  [0.0007590024999999999, 0.00010904344865283799{\ldots}   [2, 5]       \{\}
4  [0.003923978402777776, 0.0001985226397918539, {\ldots}       []       \{\}

  peak\_dist                                          correlate  \textbackslash{}
0        []  [0.006080417777777776, 0.00369355025376957, 0{\ldots}
1        []  [0.005456764444444444, 0.003991765965944491, 0{\ldots}
2    [0, 2]  [0.00329784, 0.0020613087035645777, 0.00266369{\ldots}
3    [1, 2]  [0.002674186666666666, 0.002036545650201958, 0{\ldots}
4        []  [0.006080417777777776, 0.00369355025376957, 0{\ldots}

                                            convolve
0  [0.015639536111111105, 0.007005268555061297, 0{\ldots}
1  [0.014035427777777776, 0.008028216530542623, 0{\ldots}
2  [0.008482424999999998, 0.003948725996030621, 0{\ldots}
3  [0.006878316666666666, 0.004140935319768755, 0{\ldots}
4  [0.015639536111111105, 0.007005268555061297, 0{\ldots}
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{164}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{maxes} \PY{o}{=} \PY{p}{[}\PY{n}{signal}\PY{o}{.}\PY{n}{find\PYZus{}peaks}\PY{p}{(}\PY{n}{rex}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{n}\PY{p}{]}\PY{o}{.}\PY{n}{correlate}\PY{p}{)} \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{rex}\PY{p}{)}\PY{p}{)}\PY{p}{]}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{maxes}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}
\PY{n}{maxheight} \PY{o}{=} \PY{p}{[}\PY{n}{rex}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{correlate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{m}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{m} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{maxes}\PY{p}{)}\PY{p}{]}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{maxheight}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}
\PY{n}{maxval} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{amax}\PY{p}{(}\PY{n}{maxheight}\PY{p}{)}
\PY{n}{maxind} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argmax}\PY{p}{(}\PY{n}{maxheight}\PY{p}{)}
\PY{n}{maxinds} \PY{o}{=} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{maxheight}\PY{p}{,} \PY{n}{reverse}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{top\PYZus{}idx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{maxheight}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{:}\PY{p}{]}
\PY{n}{top\PYZus{}values} \PY{o}{=} \PY{p}{[}\PY{n}{maxheight}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{top\PYZus{}idx}\PY{p}{]}
\PY{n}{top\PYZus{}seq} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{top\PYZus{}idx}\PY{p}{:}
    \PY{n}{top\PYZus{}seq}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{rex}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
    \PY{n+nb}{print}\PY{p}{(}\PY{n}{rex}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{top\PYZus{}values}\PY{p}{)}

\PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{rex}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{maxind}\PY{p}{]}\PY{o}{.}\PY{n}{correlate}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{p}{)}
\PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
[(array([3, 6]), \{\}), (array([3, 6]), \{\}), (array([ 3,  6,  8, 11]), \{\}),
(array([ 3,  6,  8, 11]), \{\}), (array([3, 6]), \{\})]
[0.003983477738678655, 0.00398398417120515, 0.003391613716366524,
0.0026732966362789864, 0.003983477738678655]
MRQYLVLSMQSS [0.01718980621246784, 0.01718980621246784, 0.01718980621246784,
0.01729663597577382, 0.017398115560299906, 0.018957853522945458,
0.020090881499368368, 0.020412413777365555, 0.02045441339375905,
0.0219375672693727]
MRQYLVLSMQSS [0.01718980621246784, 0.01718980621246784, 0.01718980621246784,
0.01729663597577382, 0.017398115560299906, 0.018957853522945458,
0.020090881499368368, 0.020412413777365555, 0.02045441339375905,
0.0219375672693727]
MRQYLVLSMQSS [0.01718980621246784, 0.01718980621246784, 0.01718980621246784,
0.01729663597577382, 0.017398115560299906, 0.018957853522945458,
0.020090881499368368, 0.020412413777365555, 0.02045441339375905,
0.0219375672693727]
FPDFYDSGEHLS [0.01718980621246784, 0.01718980621246784, 0.01718980621246784,
0.01729663597577382, 0.017398115560299906, 0.018957853522945458,
0.020090881499368368, 0.020412413777365555, 0.02045441339375905,
0.0219375672693727]
LDGLDGSGFGFD [0.01718980621246784, 0.01718980621246784, 0.01718980621246784,
0.01729663597577382, 0.017398115560299906, 0.018957853522945458,
0.020090881499368368, 0.020412413777365555, 0.02045441339375905,
0.0219375672693727]
NLDEIDRSDFGR [0.01718980621246784, 0.01718980621246784, 0.01718980621246784,
0.01729663597577382, 0.017398115560299906, 0.018957853522945458,
0.020090881499368368, 0.020412413777365555, 0.02045441339375905,
0.0219375672693727]
GDDDDNDAMELL [0.01718980621246784, 0.01718980621246784, 0.01718980621246784,
0.01729663597577382, 0.017398115560299906, 0.018957853522945458,
0.020090881499368368, 0.020412413777365555, 0.02045441339375905,
0.0219375672693727]
LDEIDRSDFGRF [0.01718980621246784, 0.01718980621246784, 0.01718980621246784,
0.01729663597577382, 0.017398115560299906, 0.018957853522945458,
0.020090881499368368, 0.020412413777365555, 0.02045441339375905,
0.0219375672693727]
DEIDRSDFGRFV [0.01718980621246784, 0.01718980621246784, 0.01718980621246784,
0.01729663597577382, 0.017398115560299906, 0.018957853522945458,
0.020090881499368368, 0.020412413777365555, 0.02045441339375905,
0.0219375672693727]
DDDDNDAMELLQ [0.01718980621246784, 0.01718980621246784, 0.01718980621246784,
0.01729663597577382, 0.017398115560299906, 0.018957853522945458,
0.020090881499368368, 0.020412413777365555, 0.02045441339375905,
0.0219375672693727]
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_7_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{206}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{out} \PY{o}{=} \PY{n}{d1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{n}{d1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sequences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{top\PYZus{}seq}\PY{p}{)}\PY{p}{]}
\PY{c+c1}{\PYZsh{}out =out[\PYZsq{}Sequences\PYZsq{}].drop\PYZus{}duplicates()}
\PY{n}{out}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{206}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
         Sequences PAM30 BLOSUM45 RRM\_SN RRM\_Corr  weighted\_matches  \textbackslash{}
474   FPDFYDSGEHLS   -65      NaN    NaN      NaN                 2
1103  LDGLDGSGFGFD   -38      NaN    NaN      NaN                 2
1507  MRQYLVLSMQSS   -62      NaN    NaN      NaN                 2
1539  MRQYLVLSMQSS   -62      NaN    NaN      NaN                 2
1561  MRQYLVLSMQSS   -62      NaN    NaN      NaN                 2

      jaro\_winkler  needleman\_wunsch  smith\_waterman  levenshtein  \textbackslash{}
474       0.477778          0.541667        0.083333     0.083333
1103      0.277778          0.541667        0.083333     0.083333
1507      0.611111          0.541667        0.166667     0.166667
1539      0.611111          0.541667        0.166667     0.166667
1561      0.611111          0.541667        0.166667     0.166667

                                   NUM\_Seq  \textbackslash{}
474   [0, 3, 5, 0, 0, 5, 2, 4, 5, 6, 1, 2]
1103  [1, 5, 4, 1, 5, 4, 2, 4, 0, 4, 0, 5]
1507  [1, 6, 2, 0, 1, 1, 1, 2, 1, 2, 2, 2]
1539  [1, 6, 2, 0, 1, 1, 1, 2, 1, 2, 2, 2]
1561  [1, 6, 2, 0, 1, 1, 1, 2, 1, 2, 2, 2]

                                               EIIP\_Seq FNS\_Seq
474   [0.0946, 0.0198, 0.1263, 0.0946, 0.0516, 0.126{\ldots}     -13
1103  [0.0, 0.1263, 0.005, 0.0, 0.1263, 0.005, 0.082{\ldots}      -2
1507  [0.0823, 0.0959, 0.0761, 0.0516, 0.0, 0.0057, {\ldots}     -10
1539  [0.0823, 0.0959, 0.0761, 0.0516, 0.0, 0.0057, {\ldots}     -10
1561  [0.0823, 0.0959, 0.0761, 0.0516, 0.0, 0.0057, {\ldots}     -10
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{174}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{n}{d1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{p}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{d1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{n}{d1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sequences}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{top\PYZus{}seq}\PY{p}{)}\PY{p}{]}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
       weighted\_matches  jaro\_winkler  needleman\_wunsch  smith\_waterman  \textbackslash{}
count       3078.000000   3078.000000       3078.000000     3078.000000
mean           1.139701      0.419312          0.526492        0.064138
std            1.350734      0.107040          0.032280        0.066640
min            0.000000      0.000000          0.500000        0.000000
25\%            0.000000      0.388889          0.500000        0.000000
50\%            0.000000      0.444444          0.500000        0.083333
75\%            2.000000      0.477778          0.541667        0.083333
max            7.000000      0.674603          0.666667        0.333333

       levenshtein
count  3078.000000
mean      0.066629
std       0.067072
min       0.000000
25\%       0.000000
50\%       0.083333
75\%       0.083333
max       0.333333
       weighted\_matches  jaro\_winkler  needleman\_wunsch  smith\_waterman  \textbackslash{}
count         15.000000     15.000000         15.000000       15.000000
mean           1.666667      0.496667          0.536111        0.122222
std            0.899735      0.139567          0.021517        0.061935
min            0.000000      0.277778          0.500000        0.000000
25\%            2.000000      0.388889          0.541667        0.083333
50\%            2.000000      0.611111          0.541667        0.166667
75\%            2.000000      0.611111          0.541667        0.166667
max            3.000000      0.611111          0.583333        0.166667

       levenshtein
count    15.000000
mean      0.122222
std       0.061935
min       0.000000
25\%       0.083333
50\%       0.166667
75\%       0.166667
max       0.166667
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{168}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{top\PYZus{}seq}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{168}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
'MRQYLVLSMQSS'
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{328}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{d1}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{pdata}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted\PYZus{}matches}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{328}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<matplotlib.axes.\_subplots.AxesSubplot at 0x7f8a414a0650>
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_11_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bsseq}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{key} \PY{o}{=} \PY{k}{lambda} \PY{n}{ss}\PY{p}{:} \PY{n+nb}{len}\PY{p}{(}\PY{n}{ss}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{reverse}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{n}{score}\PY{p}{:} \PY{n+nb}{float} \PY{o}{=} \PY{k}{lambda} \PY{n}{s}\PY{p}{:} \PY{p}{(}\PY{n}{single\PYZus{}match\PYZus{}weight} \PY{o}{*} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{s}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{n}{weight}\PY{p}{)}
        \PY{n}{matches}\PY{p}{:} \PY{n}{List} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{nmatches} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{p}{)}
        \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{seq} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p\PYZus{}ls}\PY{p}{)}\PY{p}{:}
            \PY{n}{matches}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{;} \PY{n}{nmatches}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{p}{)}\PY{p}{)}
            \PY{n}{iter\PYZus{}skip} \PY{o}{=} \PY{l+m+mi}{0}
            \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{seq}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                \PY{k}{if} \PY{n}{iter\PYZus{}skip} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
                    \PY{n}{iter\PYZus{}skip} \PY{o}{\PYZhy{}}\PY{o}{=} \PY{l+m+mi}{1}
                    \PY{k}{continue}
                \PY{k}{for} \PY{p}{(}\PY{n}{sseq}\PY{p}{,} \PY{n}{bin\PYZus{}i}\PY{p}{)} \PY{o+ow}{in} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{bsseq}\PY{p}{:}
                    \PY{n}{in\PYZus{}seq} \PY{o}{=} \PY{n}{inseq}
                    \PY{k}{if} \PY{p}{(}\PY{n}{bin\PYZus{}i} \PY{o}{==} \PY{n}{j}\PY{p}{)} \PY{o+ow}{and} \PY{p}{(}\PY{n}{in\PYZus{}seq} \PY{o}{==} \PY{n}{sseq}\PY{p}{)}\PY{p}{:}
                        \PY{n}{matches}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{p}{(}\PY{n}{sseq}\PY{p}{,} \PY{n}{bin\PYZus{}i}\PY{p}{)}\PY{p}{)}
                        \PY{n}{nmatches}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{+}\PY{o}{=} \PY{n}{score}\PY{p}{(}\PY{n}{sseq}\PY{p}{)}
                        \PY{n}{iter\PYZus{}skip} \PY{o}{+}\PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{sseq}\PY{p}{)}
                        \PY{k}{continue}
        \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{o}{.}\PY{n}{sseq\PYZus{}matches}\PY{p}{,} \PY{n+nb+bp}{self}\PY{o}{.}\PY{n}{p}\PY{o}{.}\PY{n}{weighted\PYZus{}matches} \PY{o}{=} \PY{n}{matches}\PY{p}{,} \PY{n}{nmatches}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{209}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{merge} \PY{o}{=} \PY{n}{rex}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{d1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{p}\PY{p}{,} \PY{n}{left\PYZus{}on}\PY{o}{=}\PY{n}{rex}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{right\PYZus{}on}\PY{o}{=}\PY{n}{d1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{p}\PY{o}{.}\PY{n}{index}\PY{p}{)}

\PY{n}{corr} \PY{o}{=} \PY{p}{[}\PY{n+nb}{sum}\PY{p}{(}\PY{p}{[}\PY{n}{merge}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{power} \PY{k}{for} \PY{n}{m} \PY{o+ow}{in} \PY{n}{row}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{merge}\PY{p}{)}\PY{p}{]}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{corr}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{corr}\PY{p}{)}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{merge}\PY{p}{)}\PY{p}{)}
\PY{n}{corr} \PY{o}{=} \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{interp}\PY{p}{(}\PY{n}{corr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{p}{(}\PY{n+nb}{min}\PY{p}{(}\PY{n}{corr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n+nb}{max}\PY{p}{(}\PY{n}{corr}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{merge}\PY{p}{)}\PY{p}{)}\PY{p}{]}
\PY{n}{ds} \PY{o}{=} \PY{p}{[}\PY{p}{]}\PY{p}{;} \PY{n}{c} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{dist} \PY{o+ow}{in} \PY{n+nb}{list}\PY{p}{(}\PY{n}{d}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{:}
    \PY{n}{distances} \PY{o}{=} \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{interp}\PY{p}{(}\PY{n}{merge}\PY{p}{[}\PY{n}{dist}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{p}{(}\PY{n}{merge}\PY{p}{[}\PY{n}{dist}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{merge}\PY{p}{[}\PY{n}{dist}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{]}
    \PY{n}{ds}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{distances}\PY{p}{)}
    \PY{n}{c}\PY{o}{.}\PY{n}{apppend}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{corrcoef}\PY{p}{(}\PY{n}{corr}\PY{p}{,} \PY{n}{distances}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}
\PY{n}{merge}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{corr}\PY{p}{,} \PY{n}{ds}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
[1.96198920e-02 9.92613199e-04 7.33654514e-04 2.34262847e-04
 3.80461806e-05 6.87574995e-04 5.57501701e-03] 25 3078
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        IndexError                                Traceback (most recent call last)

        <ipython-input-209-44b817db2eb2> in <module>
          3 corr = [sum([merge.iloc[i].power for m in row]) for i, row in enumerate(merge)]
          4 print(corr[0], len(corr), len(merge))
    ----> 5 corr = [np.interp(corr[i], (min(corr[i]), max(corr[i])), (0,1)) for i in range(len(merge))]
          6 ds = []; c = []
          7 for dist in list(d['dist'].keys()):


        <ipython-input-209-44b817db2eb2> in <listcomp>(.0)
          3 corr = [sum([merge.iloc[i].power for m in row]) for i, row in enumerate(merge)]
          4 print(corr[0], len(corr), len(merge))
    ----> 5 corr = [np.interp(corr[i], (min(corr[i]), max(corr[i])), (0,1)) for i in range(len(merge))]
          6 ds = []; c = []
          7 for dist in list(d['dist'].keys()):


        IndexError: list index out of range

    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{205}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{merge}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{205}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
      key\_0           seq                                               eiip  \textbackslash{}
0         0  SVPHFSDEDKDP  [0.0829, 0.0057, 0.0198, 0.0242, 0.0946, 0.082{\ldots}
1         1  VPHFSDEDKDPE  [0.0057, 0.0198, 0.0242, 0.0946, 0.0829, 0.126{\ldots}
2         2  SVPHFSEEEKEA  [0.0829, 0.0057, 0.0198, 0.0242, 0.0946, 0.082{\ldots}
3         3  VPHFSEEEKEAE  [0.0057, 0.0198, 0.0242, 0.0946, 0.0829, 0.005{\ldots}
4         4  SVPHFSDEDKDP  [0.0829, 0.0057, 0.0198, 0.0242, 0.0946, 0.082{\ldots}
{\ldots}     {\ldots}           {\ldots}                                                {\ldots}
3073   3073  FLRRIRPKLKWD  [0.0946, 0.0, 0.0959, 0.0959, 0.0, 0.0959, 0.0{\ldots}
3074   3074  LRRIRPKLKWDN  [0.0, 0.0959, 0.0959, 0.0, 0.0959, 0.0198, 0.0{\ldots}
3075   3075  RRIRPKLKWDNQ  [0.0959, 0.0959, 0.0, 0.0959, 0.0198, 0.0371, {\ldots}
3076   3076  YGGFLRRQFKVV  [0.0516, 0.005, 0.005, 0.0946, 0.0, 0.0959, 0{\ldots}
3077   3077  GGFLRRQFKVVT  [0.005, 0.005, 0.0946, 0.0, 0.0959, 0.0959, 0{\ldots}

                                                    dft  \textbackslash{}
0     [(0.06264166666666665+0j), (-0.011294400459931{\ldots}
1     [(0.056216666666666665+0j), (-0.01955731388825{\ldots}
2     [(0.033975+0j), (1.021992058759744e-05-0.00823{\ldots}
3     [(0.027549999999999998+0j), (-0.00143547036225{\ldots}
4     [(0.06264166666666665+0j), (-0.011294400459931{\ldots}
{\ldots}                                                 {\ldots}
3073  [(0.05478333333333333+0j), (0.0120289691495536{\ldots}
3074  [(0.0472+0j), (0.006376852056801644-0.00215376{\ldots}
3075  [(0.05354166666666666+0j), (0.0120914403741765{\ldots}
3076  [(0.047266666666666665+0j), (-0.01882832480253{\ldots}
3077  [(0.05080833333333333+0j), (-0.013883726825491{\ldots}

                                                   dft2  \textbackslash{}
0     [0.1252833333333333, 0.028179612473691253, 0.0{\ldots}
1     [0.11243333333333333, 0.039239587699259636, 0{\ldots}
2     [0.06795, 0.016479581260746716, 0.026961520934{\ldots}
3     [0.055099999999999996, 0.020884774229360296, 0{\ldots}
4     [0.1252833333333333, 0.028179612473691253, 0.0{\ldots}
{\ldots}                                                 {\ldots}
3073  [0.10956666666666666, 0.026094853577604493, 0{\ldots}
3074  [0.0944, 0.01346148948945863, 0.02273646728153{\ldots}
3075  [0.10708333333333332, 0.025799178373241267, 0{\ldots}
3076  [0.09453333333333333, 0.037744954227810754, 0{\ldots}
3077  [0.10161666666666666, 0.030682013917474927, 0{\ldots}

                                                   freq  \textbackslash{}
0     [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
1     [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
2     [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
3     [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
4     [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
{\ldots}                                                 {\ldots}
3073  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
3074  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
3075  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
3076  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}
3077  [0.0, 0.08333333333333333, 0.16666666666666666{\ldots}

                                                  power peak\_loc peak\_val  \textbackslash{}
0     [0.003923978402777776, 0.0001985226397918539, {\ldots}       []       \{\}
1     [0.003160313611111111, 0.000384936310701972, 0{\ldots}       []       \{\}
2     [0.001154300625, 6.789414963238858e-05, 0.0001{\ldots}   [3, 5]       \{\}
3     [0.0007590024999999999, 0.00010904344865283799{\ldots}   [2, 5]       \{\}
4     [0.003923978402777776, 0.0001985226397918539, {\ldots}       []       \{\}
{\ldots}                                                 {\ldots}      {\ldots}      {\ldots}
3073  [0.003001213611111111, 0.0001702353458091545, {\ldots}      [4]       \{\}
3074  [0.00222784, 4.530292481870129e-05, 0.00012923{\ldots}      [3]       \{\}
3075  [0.002866710069444444, 0.00016639940118357997,{\ldots}      [3]       \{\}
3076  [0.0022341377777777777, 0.0003561703924148822,{\ldots}      [4]       \{\}
3077  [0.002581486736111111, 0.00023534649450803128,{\ldots}      [4]       \{\}

     peak\_dist  {\ldots} RRM\_SN RRM\_Corr weighted\_matches jaro\_winkler  \textbackslash{}
0           []  {\ldots}    NaN      NaN                2     0.477778
1           []  {\ldots}    NaN      NaN                2     0.472222
2       [0, 2]  {\ldots}    NaN      NaN                2     0.472222
3       [1, 2]  {\ldots}    NaN      NaN                0     0.388889
4           []  {\ldots}    NaN      NaN                2     0.477778
{\ldots}        {\ldots}  {\ldots}    {\ldots}      {\ldots}              {\ldots}          {\ldots}
3073       [1]  {\ldots}    NaN      NaN                0     0.444444
3074       [0]  {\ldots}    NaN      NaN                0     0.444444
3075       [0]  {\ldots}    NaN      NaN                0     0.444444
3076       [1]  {\ldots}    NaN      NaN                0     0.000000
3077       [1]  {\ldots}    NaN      NaN                0     0.000000

     needleman\_wunsch smith\_waterman levenshtein  \textbackslash{}
0            0.541667       0.166667    0.166667
1            0.541667       0.083333    0.083333
2            0.541667       0.083333    0.083333
3            0.500000       0.000000    0.000000
4            0.541667       0.166667    0.166667
{\ldots}               {\ldots}            {\ldots}         {\ldots}
3073         0.500000       0.000000    0.000000
3074         0.500000       0.000000    0.000000
3075         0.500000       0.000000    0.000000
3076         0.500000       0.000000    0.000000
3077         0.500000       0.000000    0.000000

                                   NUM\_Seq  \textbackslash{}
0     [2, 1, 3, 6, 0, 2, 5, 5, 5, 6, 5, 3]
1     [1, 3, 6, 0, 2, 5, 5, 5, 6, 5, 3, 5]
2     [2, 1, 3, 6, 0, 2, 5, 5, 5, 6, 5, 1]
3     [1, 3, 6, 0, 2, 5, 5, 5, 6, 5, 1, 5]
4     [2, 1, 3, 6, 0, 2, 5, 5, 5, 6, 5, 3]
{\ldots}                                    {\ldots}
3073  [0, 1, 6, 6, 1, 6, 3, 6, 1, 6, 0, 5]
3074  [1, 6, 6, 1, 6, 3, 6, 1, 6, 0, 5, 2]
3075  [6, 6, 1, 6, 3, 6, 1, 6, 0, 5, 2, 2]
3076  [0, 4, 4, 0, 1, 6, 6, 2, 0, 6, 1, 1]
3077  [4, 4, 0, 1, 6, 6, 2, 0, 6, 1, 1, 2]

                                               EIIP\_Seq  FNS\_Seq
0     [0.0829, 0.0057, 0.0198, 0.0242, 0.0946, 0.082{\ldots}       -8
1     [0.0057, 0.0198, 0.0242, 0.0946, 0.0829, 0.126{\ldots}       -3
2     [0.0829, 0.0057, 0.0198, 0.0242, 0.0946, 0.082{\ldots}       -6
3     [0.0057, 0.0198, 0.0242, 0.0946, 0.0829, 0.005{\ldots}       -5
4     [0.0829, 0.0057, 0.0198, 0.0242, 0.0946, 0.082{\ldots}       -8
{\ldots}                                                 {\ldots}      {\ldots}
3073  [0.0946, 0.0, 0.0959, 0.0959, 0.0, 0.0959, 0.0{\ldots}      -15
3074  [0.0, 0.0959, 0.0959, 0.0, 0.0959, 0.0198, 0.0{\ldots}      -15
3075  [0.0959, 0.0959, 0.0, 0.0959, 0.0198, 0.0371, {\ldots}       -4
3076  [0.0516, 0.005, 0.005, 0.0946, 0.0, 0.0959, 0{\ldots}      -14
3077  [0.005, 0.005, 0.0946, 0.0, 0.0959, 0.0959, 0{\ldots}      -21

[3078 rows x 25 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]

\end{Verbatim}
\end{tcolorbox}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
